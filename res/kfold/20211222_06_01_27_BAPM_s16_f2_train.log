> device: cuda:0
> Loading DataSet from data/EEG_age_data_s16/, given 1776 samples
> Training batches: 205, Validation batches: 52
> Initializing the Training Model: BAPM
> Model Structure:
BrainAgePredictionModel(
  (stCNN): StCNN(
    (secGrabber): Conv1d(1, 5, kernel_size=(1024,), stride=(256,))
    (bn): BatchNorm1d(5, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (spatAttLayer): SpatAttLayer(
    (GaANBlk): MultiHeadPwGaANLayer(
      (pwGaAN): PwGaANLayer(
        (Wa): Linear(in_features=5, out_features=5, bias=False)
        (att_out_fc_l): Linear(in_features=5, out_features=1, bias=False)
        (att_out_fc_r): Linear(in_features=5, out_features=1, bias=False)
        (gate_fc_l): Linear(in_features=5, out_features=1, bias=False)
        (gate_fc_m): Linear(in_features=5, out_features=1, bias=False)
        (gate_fc_r): Linear(in_features=5, out_features=1, bias=False)
        (Wg): Linear(in_features=5, out_features=5, bias=False)
      )
    )
    (proj_fc): Linear(in_features=5, out_features=5, bias=False)
    (bn): BatchNorm2d(10, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (tempLayer): TempLayer(
    (gru): GRU(10, 10)
    (bn): BatchNorm1d(10, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (tranLayer): TranLayer(
    (linear_nodes): Linear(in_features=63, out_features=1, bias=True)
    (linear_embed): Linear(in_features=10, out_features=1, bias=True)
  )
)
> Model sent to cuda:0
> Using SmoothL1Loss as the Loss Function.
> Constructing the Optimizer: ADAM

learning_rate = 0.01, epochs = 100, num_workers = 50
eval_freq = 5, batch_size = 5, optimizer = ADAM
folds = 5, valid_fold_id = 2

Start Training!
------------------------------------------------------------------------
Training Round 1: loss = 15.922483, time_cost = 28.3941 sec (0.0277 sec per sample), MAE = 16.4144, RMSE = 21.0618, MAPE = 0.4578
Training Round 2: loss = 11.777344, time_cost = 24.9607 sec (0.0244 sec per sample), MAE = 12.2666, RMSE = 15.2039, MAPE = 0.3547
Training Round 3: loss = 11.645144, time_cost = 24.5410 sec (0.0240 sec per sample), MAE = 12.1377, RMSE = 14.8714, MAPE = 0.3518
Training Round 4: loss = 11.268358, time_cost = 25.6395 sec (0.0250 sec per sample), MAE = 11.7579, RMSE = 14.7033, MAPE = 0.3369
Training Round 5: loss = 11.173960, time_cost = 24.3805 sec (0.0238 sec per sample), MAE = 11.6646, RMSE = 14.5687, MAPE = 0.3335
!!! Validation: loss = 10.992767, MAE = 11.4788, RMSE = 14.9178, MAPE = 0.3073
Training Round 6: loss = 11.221626, time_cost = 24.7695 sec (0.0242 sec per sample), MAE = 11.7118, RMSE = 14.5667, MAPE = 0.3380
Training Round 7: loss = 10.895566, time_cost = 26.9084 sec (0.0263 sec per sample), MAE = 11.3884, RMSE = 14.0474, MAPE = 0.3338
Training Round 8: loss = 11.102801, time_cost = 24.8465 sec (0.0243 sec per sample), MAE = 11.5947, RMSE = 14.4756, MAPE = 0.3351
Training Round 9: loss = 10.774284, time_cost = 25.3835 sec (0.0248 sec per sample), MAE = 11.2623, RMSE = 13.9858, MAPE = 0.3326
Training Round 10: loss = 10.299951, time_cost = 24.8063 sec (0.0242 sec per sample), MAE = 10.7897, RMSE = 13.5772, MAPE = 0.3110
!!! Validation: loss = 9.430002, MAE = 9.9173, RMSE = 12.4195, MAPE = 0.2954
Training Round 11: loss = 10.300159, time_cost = 26.1382 sec (0.0255 sec per sample), MAE = 10.7894, RMSE = 13.5910, MAPE = 0.3110
Training Round 12: loss = 10.140507, time_cost = 23.0542 sec (0.0225 sec per sample), MAE = 10.6305, RMSE = 13.4291, MAPE = 0.3125
Training Round 13: loss = 9.444415, time_cost = 23.3570 sec (0.0228 sec per sample), MAE = 9.9287, RMSE = 12.7718, MAPE = 0.2852
Training Round 14: loss = 9.736175, time_cost = 25.0389 sec (0.0245 sec per sample), MAE = 10.2251, RMSE = 13.1919, MAPE = 0.2945
Training Round 15: loss = 9.418955, time_cost = 25.4840 sec (0.0249 sec per sample), MAE = 9.9071, RMSE = 12.9673, MAPE = 0.2847
!!! Validation: loss = 8.659759, MAE = 9.1475, RMSE = 11.3078, MAPE = 0.2858
Model: model_save/20211222_06_01_27.pth has been saved since it achieves smaller loss.
Training Round 16: loss = 9.206394, time_cost = 24.1596 sec (0.0236 sec per sample), MAE = 9.6928, RMSE = 12.5721, MAPE = 0.2780
Training Round 17: loss = 9.192189, time_cost = 25.4719 sec (0.0249 sec per sample), MAE = 9.6821, RMSE = 12.6269, MAPE = 0.2796
Training Round 18: loss = 8.974453, time_cost = 23.8939 sec (0.0233 sec per sample), MAE = 9.4602, RMSE = 12.4070, MAPE = 0.2728
Training Round 19: loss = 9.042239, time_cost = 25.7542 sec (0.0252 sec per sample), MAE = 9.5299, RMSE = 12.4549, MAPE = 0.2751
Training Round 20: loss = 9.154235, time_cost = 25.1755 sec (0.0246 sec per sample), MAE = 9.6391, RMSE = 12.6752, MAPE = 0.2763
!!! Validation: loss = 8.266290, MAE = 8.7475, RMSE = 11.5970, MAPE = 0.2297
Model: model_save/20211222_06_01_27.pth has been saved since it achieves smaller loss.
Training Round 21: loss = 8.778411, time_cost = 23.7094 sec (0.0232 sec per sample), MAE = 9.2641, RMSE = 11.9959, MAPE = 0.2671
Training Round 22: loss = 8.916785, time_cost = 24.9464 sec (0.0244 sec per sample), MAE = 9.4047, RMSE = 12.2608, MAPE = 0.2699
Training Round 23: loss = 8.639119, time_cost = 25.4014 sec (0.0248 sec per sample), MAE = 9.1283, RMSE = 11.9023, MAPE = 0.2656
Training Round 24: loss = 8.555260, time_cost = 24.1288 sec (0.0236 sec per sample), MAE = 9.0414, RMSE = 11.7770, MAPE = 0.2618
Training Round 25: loss = 8.577305, time_cost = 25.0106 sec (0.0244 sec per sample), MAE = 9.0662, RMSE = 11.9042, MAPE = 0.2641
!!! Validation: loss = 8.605117, MAE = 9.0924, RMSE = 11.3264, MAPE = 0.2786
Training Round 26: loss = 8.665663, time_cost = 25.8537 sec (0.0252 sec per sample), MAE = 9.1535, RMSE = 11.8502, MAPE = 0.2628
Training Round 27: loss = 8.475440, time_cost = 25.9212 sec (0.0253 sec per sample), MAE = 8.9597, RMSE = 11.8761, MAPE = 0.2608
Training Round 28: loss = 8.597680, time_cost = 26.2535 sec (0.0256 sec per sample), MAE = 9.0872, RMSE = 11.8263, MAPE = 0.2672
Training Round 29: loss = 8.321939, time_cost = 24.1304 sec (0.0236 sec per sample), MAE = 8.8057, RMSE = 11.5208, MAPE = 0.2553
Training Round 30: loss = 8.422556, time_cost = 26.4711 sec (0.0259 sec per sample), MAE = 8.9080, RMSE = 11.8723, MAPE = 0.2522
!!! Validation: loss = 7.761576, MAE = 8.2506, RMSE = 10.8890, MAPE = 0.2280
Model: model_save/20211222_06_01_27.pth has been saved since it achieves smaller loss.
Training Round 31: loss = 8.530299, time_cost = 24.1752 sec (0.0236 sec per sample), MAE = 9.0176, RMSE = 11.8484, MAPE = 0.2599
Training Round 32: loss = 8.501984, time_cost = 24.8068 sec (0.0242 sec per sample), MAE = 8.9907, RMSE = 11.8281, MAPE = 0.2551
Training Round 33: loss = 8.688327, time_cost = 24.0709 sec (0.0235 sec per sample), MAE = 9.1756, RMSE = 12.1429, MAPE = 0.2630
Training Round 34: loss = 8.240178, time_cost = 24.3083 sec (0.0237 sec per sample), MAE = 8.7241, RMSE = 11.4719, MAPE = 0.2516
Training Round 35: loss = 8.316372, time_cost = 23.1677 sec (0.0226 sec per sample), MAE = 8.8047, RMSE = 11.4926, MAPE = 0.2571
!!! Validation: loss = 20.261522, MAE = 20.7590, RMSE = 23.3384, MAPE = 0.6663
Training Round 36: loss = 8.628016, time_cost = 24.0289 sec (0.0235 sec per sample), MAE = 9.1155, RMSE = 11.8445, MAPE = 0.2657
Training Round 37: loss = 8.319982, time_cost = 23.2814 sec (0.0227 sec per sample), MAE = 8.8063, RMSE = 11.7453, MAPE = 0.2565
Training Round 38: loss = 8.279555, time_cost = 24.7932 sec (0.0242 sec per sample), MAE = 8.7682, RMSE = 11.5747, MAPE = 0.2556
Training Round 39: loss = 8.087476, time_cost = 24.1060 sec (0.0235 sec per sample), MAE = 8.5735, RMSE = 11.3855, MAPE = 0.2465
Training Round 40: loss = 8.188115, time_cost = 24.7047 sec (0.0241 sec per sample), MAE = 8.6725, RMSE = 11.4942, MAPE = 0.2593
!!! Validation: loss = 7.748232, MAE = 8.2396, RMSE = 10.3478, MAPE = 0.2564
Model: model_save/20211222_06_01_27.pth has been saved since it achieves smaller loss.
Training Round 41: loss = 8.173991, time_cost = 24.1077 sec (0.0235 sec per sample), MAE = 8.6599, RMSE = 11.5041, MAPE = 0.2463
Training Round 42: loss = 7.968709, time_cost = 24.1415 sec (0.0236 sec per sample), MAE = 8.4555, RMSE = 11.1726, MAPE = 0.2440
Training Round 43: loss = 8.185220, time_cost = 23.1516 sec (0.0226 sec per sample), MAE = 8.6695, RMSE = 11.5965, MAPE = 0.2490
Training Round 44: loss = 7.962492, time_cost = 23.4206 sec (0.0229 sec per sample), MAE = 8.4462, RMSE = 11.2301, MAPE = 0.2415
Training Round 45: loss = 7.904980, time_cost = 24.5088 sec (0.0239 sec per sample), MAE = 8.3873, RMSE = 11.3733, MAPE = 0.2393
!!! Validation: loss = 8.651946, MAE = 9.1352, RMSE = 11.5093, MAPE = 0.2893
Training Round 46: loss = 8.070300, time_cost = 23.4243 sec (0.0229 sec per sample), MAE = 8.5546, RMSE = 11.4419, MAPE = 0.2440
Training Round 47: loss = 7.981786, time_cost = 22.9284 sec (0.0224 sec per sample), MAE = 8.4652, RMSE = 11.2721, MAPE = 0.2429
Training Round 48: loss = 7.931980, time_cost = 22.3123 sec (0.0218 sec per sample), MAE = 8.4146, RMSE = 11.2263, MAPE = 0.2470
Training Round 49: loss = 7.952507, time_cost = 21.5421 sec (0.0210 sec per sample), MAE = 8.4366, RMSE = 11.2267, MAPE = 0.2417
Training Round 50: loss = 7.940993, time_cost = 21.2733 sec (0.0208 sec per sample), MAE = 8.4280, RMSE = 11.3274, MAPE = 0.2397
!!! Validation: loss = 7.576594, MAE = 8.0583, RMSE = 10.6840, MAPE = 0.2161
Model: model_save/20211222_06_01_27.pth has been saved since it achieves smaller loss.
Training Round 51: loss = 8.107582, time_cost = 22.7903 sec (0.0223 sec per sample), MAE = 8.5964, RMSE = 11.7133, MAPE = 0.2449
Training Round 52: loss = 8.322254, time_cost = 22.5084 sec (0.0220 sec per sample), MAE = 8.8095, RMSE = 11.6945, MAPE = 0.2511
Training Round 53: loss = 8.480434, time_cost = 22.1361 sec (0.0216 sec per sample), MAE = 8.9619, RMSE = 11.9750, MAPE = 0.2547
Training Round 54: loss = 8.199921, time_cost = 21.7512 sec (0.0212 sec per sample), MAE = 8.6826, RMSE = 11.6145, MAPE = 0.2457
Training Round 55: loss = 7.548676, time_cost = 21.5638 sec (0.0211 sec per sample), MAE = 8.0266, RMSE = 10.9049, MAPE = 0.2301
!!! Validation: loss = 7.571452, MAE = 8.0582, RMSE = 10.2506, MAPE = 0.2534
Model: model_save/20211222_06_01_27.pth has been saved since it achieves smaller loss.
Training Round 56: loss = 8.011918, time_cost = 21.6071 sec (0.0211 sec per sample), MAE = 8.4970, RMSE = 11.2984, MAPE = 0.2412
Training Round 57: loss = 8.192012, time_cost = 23.2060 sec (0.0227 sec per sample), MAE = 8.6770, RMSE = 11.4861, MAPE = 0.2419
Training Round 58: loss = 8.016482, time_cost = 21.5409 sec (0.0210 sec per sample), MAE = 8.5000, RMSE = 11.4063, MAPE = 0.2466
Training Round 59: loss = 7.769876, time_cost = 20.8689 sec (0.0204 sec per sample), MAE = 8.2548, RMSE = 11.1186, MAPE = 0.2368
Training Round 60: loss = 7.672242, time_cost = 22.1370 sec (0.0216 sec per sample), MAE = 8.1562, RMSE = 10.8418, MAPE = 0.2325
!!! Validation: loss = 7.196586, MAE = 7.6824, RMSE = 10.5305, MAPE = 0.2127
Model: model_save/20211222_06_01_27.pth has been saved since it achieves smaller loss.
Training Round 61: loss = 7.888554, time_cost = 21.7736 sec (0.0213 sec per sample), MAE = 8.3745, RMSE = 11.2562, MAPE = 0.2354
Training Round 62: loss = 7.516889, time_cost = 21.8182 sec (0.0213 sec per sample), MAE = 8.0010, RMSE = 10.8581, MAPE = 0.2265
Training Round 63: loss = 7.908320, time_cost = 22.5429 sec (0.0220 sec per sample), MAE = 8.3915, RMSE = 11.2816, MAPE = 0.2412
Training Round 64: loss = 7.933947, time_cost = 20.9808 sec (0.0205 sec per sample), MAE = 8.4191, RMSE = 11.3456, MAPE = 0.2404
Training Round 65: loss = 7.739272, time_cost = 21.2138 sec (0.0207 sec per sample), MAE = 8.2230, RMSE = 11.1561, MAPE = 0.2335
!!! Validation: loss = 7.319109, MAE = 7.8038, RMSE = 9.9986, MAPE = 0.2385
Training Round 66: loss = 7.544073, time_cost = 21.5747 sec (0.0211 sec per sample), MAE = 8.0264, RMSE = 10.7456, MAPE = 0.2299
Training Round 67: loss = 7.754264, time_cost = 21.0327 sec (0.0205 sec per sample), MAE = 8.2367, RMSE = 10.9396, MAPE = 0.2356
Training Round 68: loss = 7.893811, time_cost = 21.6938 sec (0.0212 sec per sample), MAE = 8.3830, RMSE = 11.1643, MAPE = 0.2394
Training Round 69: loss = 7.765430, time_cost = 22.5455 sec (0.0220 sec per sample), MAE = 8.2479, RMSE = 11.1284, MAPE = 0.2411
Training Round 70: loss = 7.981821, time_cost = 21.6039 sec (0.0211 sec per sample), MAE = 8.4674, RMSE = 11.2866, MAPE = 0.2456
!!! Validation: loss = 6.719247, MAE = 7.2033, RMSE = 9.7005, MAPE = 0.2063
Model: model_save/20211222_06_01_27.pth has been saved since it achieves smaller loss.
Training Round 71: loss = 7.692223, time_cost = 22.4316 sec (0.0219 sec per sample), MAE = 8.1759, RMSE = 11.1784, MAPE = 0.2331
Training Round 72: loss = 7.732015, time_cost = 23.1927 sec (0.0226 sec per sample), MAE = 8.2183, RMSE = 11.0400, MAPE = 0.2355
Training Round 73: loss = 7.640902, time_cost = 21.9638 sec (0.0214 sec per sample), MAE = 8.1238, RMSE = 10.8616, MAPE = 0.2301
Training Round 74: loss = 7.772084, time_cost = 21.6206 sec (0.0211 sec per sample), MAE = 8.2563, RMSE = 11.2197, MAPE = 0.2358
Training Round 75: loss = 7.735513, time_cost = 22.8917 sec (0.0224 sec per sample), MAE = 8.2180, RMSE = 11.0829, MAPE = 0.2371
!!! Validation: loss = 7.066651, MAE = 7.5426, RMSE = 10.0538, MAPE = 0.2046
Training Round 76: loss = 7.740967, time_cost = 20.8381 sec (0.0203 sec per sample), MAE = 8.2253, RMSE = 11.0216, MAPE = 0.2373
Training Round 77: loss = 7.582516, time_cost = 22.0976 sec (0.0216 sec per sample), MAE = 8.0681, RMSE = 10.8433, MAPE = 0.2304
Training Round 78: loss = 7.736596, time_cost = 22.9236 sec (0.0224 sec per sample), MAE = 8.2233, RMSE = 10.8768, MAPE = 0.2383
Training Round 79: loss = 7.580859, time_cost = 21.1398 sec (0.0206 sec per sample), MAE = 8.0679, RMSE = 10.8124, MAPE = 0.2293
Training Round 80: loss = 7.649051, time_cost = 21.6129 sec (0.0211 sec per sample), MAE = 8.1339, RMSE = 10.8027, MAPE = 0.2367
!!! Validation: loss = 7.546826, MAE = 8.0382, RMSE = 10.5978, MAPE = 0.2267
Training Round 81: loss = 7.770232, time_cost = 22.6617 sec (0.0221 sec per sample), MAE = 8.2566, RMSE = 11.0915, MAPE = 0.2410
Training Round 82: loss = 7.517484, time_cost = 21.3558 sec (0.0209 sec per sample), MAE = 8.0019, RMSE = 10.7003, MAPE = 0.2276
Training Round 83: loss = 7.561079, time_cost = 21.1026 sec (0.0206 sec per sample), MAE = 8.0429, RMSE = 10.9621, MAPE = 0.2364
Training Round 84: loss = 7.568307, time_cost = 22.9598 sec (0.0224 sec per sample), MAE = 8.0511, RMSE = 10.8927, MAPE = 0.2324
Training Round 85: loss = 7.555128, time_cost = 21.4058 sec (0.0209 sec per sample), MAE = 8.0394, RMSE = 10.7751, MAPE = 0.2316
!!! Validation: loss = 7.196563, MAE = 7.6862, RMSE = 9.6985, MAPE = 0.2418
Training Round 86: loss = 7.751189, time_cost = 23.5086 sec (0.0230 sec per sample), MAE = 8.2367, RMSE = 11.0664, MAPE = 0.2381
Training Round 87: loss = 7.812837, time_cost = 23.0537 sec (0.0225 sec per sample), MAE = 8.2980, RMSE = 11.3028, MAPE = 0.2413
Training Round 88: loss = 7.259092, time_cost = 21.9678 sec (0.0215 sec per sample), MAE = 7.7407, RMSE = 10.7008, MAPE = 0.2248
Training Round 89: loss = 7.630609, time_cost = 21.8346 sec (0.0213 sec per sample), MAE = 8.1134, RMSE = 10.9580, MAPE = 0.2317
Training Round 90: loss = 7.540794, time_cost = 23.7209 sec (0.0232 sec per sample), MAE = 8.0261, RMSE = 10.8233, MAPE = 0.2357
!!! Validation: loss = 6.918942, MAE = 7.4021, RMSE = 9.6743, MAPE = 0.2101
Training Round 91: loss = 7.786764, time_cost = 21.5823 sec (0.0211 sec per sample), MAE = 8.2743, RMSE = 11.0890, MAPE = 0.2384
Training Round 92: loss = 7.550851, time_cost = 21.7612 sec (0.0213 sec per sample), MAE = 8.0371, RMSE = 10.9015, MAPE = 0.2311
Training Round 93: loss = 8.036270, time_cost = 22.5648 sec (0.0220 sec per sample), MAE = 8.5215, RMSE = 11.2324, MAPE = 0.2425
Training Round 94: loss = 7.577111, time_cost = 21.5995 sec (0.0211 sec per sample), MAE = 8.0618, RMSE = 10.8041, MAPE = 0.2310
Training Round 95: loss = 7.750387, time_cost = 21.8559 sec (0.0213 sec per sample), MAE = 8.2379, RMSE = 11.0130, MAPE = 0.2337
!!! Validation: loss = 7.575727, MAE = 8.0526, RMSE = 10.7239, MAPE = 0.2145
Training Round 96: loss = 7.601387, time_cost = 22.5956 sec (0.0221 sec per sample), MAE = 8.0830, RMSE = 11.0925, MAPE = 0.2364
Training Round 97: loss = 7.443120, time_cost = 21.4323 sec (0.0209 sec per sample), MAE = 7.9254, RMSE = 10.7016, MAPE = 0.2275
Training Round 98: loss = 7.483388, time_cost = 21.1219 sec (0.0206 sec per sample), MAE = 7.9665, RMSE = 10.7304, MAPE = 0.2292
Training Round 99: loss = 7.516656, time_cost = 22.6676 sec (0.0221 sec per sample), MAE = 7.9966, RMSE = 10.7363, MAPE = 0.2304
Training Round 100: loss = 7.523782, time_cost = 21.8176 sec (0.0213 sec per sample), MAE = 8.0068, RMSE = 10.8597, MAPE = 0.2334
!!! Validation: loss = 7.546034, MAE = 8.0295, RMSE = 10.9087, MAPE = 0.2113
> Training finished.
